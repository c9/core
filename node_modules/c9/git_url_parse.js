define(function(require, exports, module) {
    "use strict";
    
    var Url = require("url");
    
    module.exports = function(url) {
        var m = url.match(/^(git)@([\w\.\d\-\_]+)(?:\/|:)([\w\.\d\-\_\/]+)/);
        if (m) {
            return {
                protocol: "ssh:",
                auth: m[1],
                hostname: m[2],
                pathname: m[3]
            };
        }
    
        var parsed = Url.parse(url);
        if (
            parsed &&
            parsed.protocol &&
            parsed.protocol.match(/^(git|http|https):$/) &&
            parsed.hostname &&
            parsed.slashes &&
            parsed.pathname
        )
            return {
                protocol: parsed.protocol,
                auth: parsed.auth || "",
                hostname: parsed.hostname,
                pathname: parsed.pathname.replace(/^\/+/, ""),
                full: url
            };
        else
            return null;
    };
});