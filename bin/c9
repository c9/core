#!/usr/bin/env node

// Architect
var architect = require("architect");

// Add ability to load AMD modules
require("amd-loader");


architect.resolveConfig(require("../configs/cli.js")(),
  __dirname + "/../plugins", function (err, config) {
    if (err) throw err.message;

    var cli;
    var app = architect.createApp(config, function(err, app){
        if (err) throw err;

        cli.start();
    });
    app.on("service", function(name, plugin){
        if (name == "cli")
            cli = plugin;
        
        if (!plugin.name)
            plugin.name = name;
    });
});